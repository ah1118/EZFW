<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aircraft Type Selector with Weight and Passenger Information</title>
    <style>
        body {
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            justify-content: center;
            flex-wrap: wrap;
        }

        .dropdown-box {
            width: 321px;
            padding: 20px;
            border: 1px solid #ccc;
            display: inline-block;
            margin: 0.5cm;
        }

        select, input[type="text"], input[type="number"] {
            width: 100%;
            padding: 5px;
            box-sizing: border-box;
        }

        .dropdown-box > * {
            margin-bottom: 0.5cm;
        }

        .inline {
            display: flex;
            align-items: center;
        }

        .inline label {
            margin-right: 10px;
        }

        .passenger-inputs {
            display: flex;
            justify-content: space-between;
        }

        .passenger-inputs input {
            width: 32%;
            padding: 5px;
        }

        .limitation-section {
            display: flex;
            justify-content: space-between;
        }

        .limitation-section input {
            width: 48%;
        }

        .pax-total {
            font-weight: bold;
        }

        .limit-box {
            border: 1px solid black;
            padding: 10px;
            font-weight: bold;
            margin-top: 10px;
            width: calc(50% - 5px);
            display: inline-block;
            text-align: center;
        }

        .limits-container {
            display: flex;
            justify-content: space-between;
        }

        .limit-label {
            font-weight: bold;
            text-align: center;
            margin-bottom: 5px;
        }

        .crew-container {
            display: flex;
            justify-content: space-between;
        }

        .box1 {
            background-color: #ED5564;
        }
    </style>
</head>
<body>

<div class="dropdown-box box1">
    <div>
        <label for="aircraft-type">Aircraft Type:</label>
        <select class="aircraft-type" onchange="updateAircraftOptions(this)">
            <option value="">--Select--</option>
            <option value="B737-800">Boeing 737-800</option>
            <option value="B737-600">Boeing 737-600</option>
            <option value="A330-200">Airbus A330-200</option>
            <option value="B737-700">Boeing 737-700</option>
        </select>
    </div>

    <div>
        <label for="aircraft-options">Tail Number:</label>
        <select class="aircraft-options" onchange="updateWeight(this)">
            <option value="">--Select--</option>
        </select>
    </div>

    <div class="crew-container">
        <div>
            <label for="pnt">PNT:</label>
            <select class="pnt" disabled onchange="calculateAdjustedBasicWeight(this)">
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
            </select>
        </div>

        <div>
            <label for="pnc">PNC:</label>
            <select class="pnc" disabled onchange="calculateAdjustedBasicWeight(this)">
                <option value="">--Select--</option>
            </select>
        </div>
    </div>

    <div class="inline">
        <label for="basic-weight">Basic Weight (kgs):</label>
        <input type="text" class="basic-weight" readonly>
    </div>

    <div class="pax-total">Aircraft Limitation:</div>
    <div class="limitation-section">
        <input type="number" class="mtow" placeholder="MTOW (kgs)" min="0" readonly>
        <input type="number" class="mlw" placeholder="MLW (kgs)" min="0" readonly>
    </div>

    <div class="inline">
        <label for="trip-fuel">Trip Fuel (kgs):</label>
        <input type="number" class="trip-fuel" oninput="calculateAdjustedBasicWeight(this)">
    </div>

    <div class="pax-total">PAX TOTAL:</div>

    <div class="passenger-inputs">
        <input type="number" class="adt" placeholder="ADT" oninput="calculateAdjustedBasicWeight(this)">
        <input type="number" class="chd" placeholder="CHD" oninput="calculateAdjustedBasicWeight(this)">
        <input type="number" class="inf" placeholder="INF" oninput="calculateAdjustedBasicWeight(this)">
    </div>

    <div class="inline">
        <label for="bags">BAGS:</label>
        <input type="number" class="bags" oninput="calculateAdjustedBasicWeight(this)">
    </div>

    <div class="limits-container">
        <div>
            <div class="limit-label">LIMIT TAKEOFF:</div>
            <div class="limit-box takeoff-box">
                <span class="limit-takeoff">0</span> KGS
            </div>
        </div>

        <div>
            <div class="limit-label">LIMIT LANDING:</div>
            <div class="limit-box landing-box">
                <span class="limit-landing">0</span> KGS
            </div>
        </div>
    </div>
</div>

<script>
const weightData = {
    '7TVJJ': 43211,
    '7TVJK': 43212,
    '7TVKS': 40321,
    '7TVKT': 40322,
    '7TVJQ': 39000,
    '7TVJR': 39001,
    '7TVJS': 39002,
    '7TVJT': 39003,
    '7TVJU': 39004,
    '7TVJV': 122053,
    '7TVJW': 122166,
    '7TVJX': 122462,
    '7TVJY': 122047,
    '7TVJZ': 121376
};

const limitationData = {
    'B737-800': { mtow: 79015, mlw: 65317 },
    'B737-700': { mtow: 74000, mlw: 60123 },
    'A330-200': { mtow: 230000, mlw: 180000 },
    'B737-600': { mtow: 65090, mlw: 54657 }
};

let defaultBasicWeight = 0;

function updateAircraftOptions(selectElement) {
    const aircraftType = selectElement.value;
    const flightBox = selectElement.closest('.dropdown-box');
    const aircraftOptions = flightBox.querySelector('.aircraft-options');
    const pntSelect = flightBox.querySelector('.pnt');
    const pncSelect = flightBox.querySelector('.pnc');
    const mtowField = flightBox.querySelector('.mtow');
    const mlwField = flightBox.querySelector('.mlw');

    aircraftOptions.innerHTML = '<option value="">--Select--</option>';
    pntSelect.disabled = false;
    pncSelect.disabled = false;
    pncSelect.innerHTML = '<option value="">--Select--</option>';
    pntSelect.innerHTML = '<option value="2">2</option><option value="3">3</option><option value="4">4</option>';

    // Populate tail numbers and PNC options based on aircraft type
    if (aircraftType === 'B737-800') {
        aircraftOptions.innerHTML += '<option value="7TVJJ">7TVJJ</option>';
        aircraftOptions.innerHTML += '<option value="7TVJK">7TVJK</option>';
        pncSelect.innerHTML = '<option value="6">6</option><option value="5">5</option><option value="4">4</option><option value="3">3</option>';
        pncSelect.value = '6';
        pntSelect.value = '2';
    } else if (aircraftType === 'B737-700') {
        aircraftOptions.innerHTML += '<option value="7TVKS">7TVKS</option>';
        aircraftOptions.innerHTML += '<option value="7TVKT">7TVKT</option>';
        pncSelect.innerHTML = '<option value="4">4</option><option value="3">3</option>';
        pncSelect.value = '4';
        pntSelect.value = '2';
    } else if (aircraftType === 'A330-200') {
        aircraftOptions.innerHTML += '<option value="7TVJV">7TVJV</option>';
        aircraftOptions.innerHTML += '<option value="7TVJW">7TVJW</option>';
        aircraftOptions.innerHTML += '<option value="7TVJX">7TVJX</option>';
        aircraftOptions.innerHTML += '<option value="7TVJY">7TVJY</option>';
        aircraftOptions.innerHTML += '<option value="7TVJZ">7TVJZ</option>';  
        pncSelect.innerHTML = '<option value="12">12</option><option value="11">11</option><option value="10">10</option><option value="9">9</option><option value="8">8</option><option value="7">7</option><option value="6">6</option>';
        pncSelect.value = '12';
        pntSelect.value = '2';
    } else if (aircraftType === 'B737-600') {
        aircraftOptions.innerHTML += '<option value="7TVJQ">7TVJQ</option>';
        aircraftOptions.innerHTML += '<option value="7TVJR">7TVJR</option>';
        pncSelect.innerHTML = '<option value="4">4</option><option value="3">3</option>';
        pncSelect.value = '4';
        pntSelect.value = '2';
    }

    // Pre-fill MTOW and MLW with default values based on aircraft type, but make them editable
    if (limitationData[aircraftType]) {
        mtowField.value = limitationData[aircraftType].mtow;
        mlwField.value = limitationData[aircraftType].mlw;

        // Add validation to prevent exceeding default MTOW/MLW
        mtowField.oninput = function() {
            if (parseFloat(mtowField.value) > limitationData[aircraftType].mtow) {
                mtowField.value = 0; // Reset to 0 if value exceeds default MTOW
            }
        };

        mlwField.oninput = function() {
            if (parseFloat(mlwField.value) > limitationData[aircraftType].mlw) {
                mlwField.value = 0; // Reset to 0 if value exceeds default MLW
            }
        };
    }
}


function updateWeight(selectElement) {
    const tailNumber = selectElement.value;
    const flightBox = selectElement.closest('.dropdown-box');
    const basicWeight = weightData[tailNumber] || '';
    defaultBasicWeight = basicWeight;
    flightBox.querySelector('.basic-weight').value = basicWeight;
    calculateAdjustedBasicWeight(selectElement);
}

function calculateAdjustedBasicWeight(selectElement) {
    const flightBox = selectElement.closest('.dropdown-box');
    const basicWeightField = flightBox.querySelector('.basic-weight');
    let adjustedBasicWeight = defaultBasicWeight;

    const pnt = parseFloat(flightBox.querySelector('.pnt').value) || 2;
    const pnc = parseFloat(flightBox.querySelector('.pnc').value) || 6;

    const pntAdjustment = (pnt - 2) * 80;
    const pncAdjustment = (pnc - 6) * 65;

    adjustedBasicWeight += pntAdjustment + pncAdjustment;
    basicWeightField.value = adjustedBasicWeight.toFixed(2);

    calculateLimits(flightBox, adjustedBasicWeight);
}

function calculateLimits(flightBox, adjustedBasicWeight) {
    const mtow = parseFloat(flightBox.querySelector('.mtow').value) || 0;
    const mlw = parseFloat(flightBox.querySelector('.mlw').value) || 0;
    const tripFuelValue = parseFloat(flightBox.querySelector('.trip-fuel').value);
    const adtValue = parseFloat(flightBox.querySelector('.adt').value);
    const chdValue = parseFloat(flightBox.querySelector('.chd').value) || 0;
    const infValue = parseFloat(flightBox.querySelector('.inf').value) || 0;
    const bagsValue = parseFloat(flightBox.querySelector('.bags').value);

    // Check if tripFuelValue, adtValue, or bagsValue are not provided or invalid
    if (isNaN(tripFuelValue) || isNaN(adtValue) || isNaN(bagsValue) || isNaN(mtow) || isNaN(mlw)) {
        // If any of the required values is missing or invalid, stop execution
        return;
    }

    // Calculate LIMIT TAKEOFF and LIMIT LANDING
    const limitTakeoff = mtow - (adjustedBasicWeight + (adtValue * 80) + (chdValue * 35) + (infValue * 10) + bagsValue);
    const limitLanding = mlw + tripFuelValue - (adjustedBasicWeight + (adtValue * 80) + (chdValue * 35) + (infValue * 10) + bagsValue);

    // Update the limit display
    flightBox.querySelector('.limit-takeoff').innerText = limitTakeoff.toFixed(2);
    flightBox.querySelector('.limit-landing').innerText = limitLanding.toFixed(2);
}
</script>

</body>
</html>
